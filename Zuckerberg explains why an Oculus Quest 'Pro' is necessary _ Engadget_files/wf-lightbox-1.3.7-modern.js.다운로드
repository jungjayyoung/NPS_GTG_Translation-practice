!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("wafer-lightbox",[],t):"object"==typeof exports?exports["wafer-lightbox"]=t():(e.wafer=e.wafer||{},e.wafer.wafers=e.wafer.wafers||{},e.wafer.wafers["wafer-lightbox"]=t())}("undefined"!=typeof self?self:this,function(){return function(e){function t(n){if(o[n])return o[n].exports;var r=o[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var o={};return t.m=e,t.c=o,t.d=function(e,o,n){t.o(e,o)||Object.defineProperty(e,o,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="https://s.yimg.com/aaq/wf/",t(t.s="./src/entry.js")}({"./src/entry.js":function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},s=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),c=window.wafer.utils,u=c.findAncestor,f=c.getTemplateContent,p=c.setTimeout,d=["handleClick"],h="data-wf-",w=window.wafer.base,y=function(){function e(t){var o=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=r.errorClass,i=r.selector,s=r.successClass,c=r.wrapperMap;n(this,e);var p=t.getAttribute(h+"boundary"),w=t.getAttribute(h+"lightbox-target"),y=t.getAttribute(h+"lightbox-trigger")||"click",b=t.getAttribute(h+"lightbox-delay");this._util={elem:t,errorClass:l,delay:null===b||void 0===b?0:Number(b),trigger:y,wrapperMap:c,templateText:w&&f((p&&u(t,p)||document.body).querySelector(w)),selector:i,successClass:s},this._state=a({},this._state),d.forEach(function(e){o[e]=o[e].bind(o)}),"onLoad"===y&&this.open()}return s(e,[{key:"destroy",value:function(){this._util.elem.classList.add("wafer-destroyed")}},{key:"open",value:function(){var e=this._util,t=e.delay,o=e.templateText,n=e.wrapperMap,r=n.contentElem,l=n.elem,i=n.wrapperElem;this.willOpen(),Object.assign(document.body.style,{overflow:"hidden"}),l.style.display="",r.innerHTML=o,i.setAttribute("tabIndex",-1),i.focus(),p(function(){return i.focus()},5),i.classList.add("wafer-lightbox-open"),document.body.classList.add("wafer-lightbox-open"),w.lock(document.body),p(function(){w.unlock(r),w.sync(r),w.emitWaferEvent("lightbox:open",{elem:l,meta:{}})},t)}},{key:"handleClick",value:function(){this._util.wrapperMap&&("click"===this._util.trigger&&this.open())}}]),e}();y.events={click:[["wafer-lightbox","handleClick"]]};var b=y,v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},g=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),m=function e(t,o,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,o);if(void 0===r){var l=Object.getPrototypeOf(t);return null===l?void 0:e(l,o,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},_=window.wafer.features.isTouchSafariDevice,C=["_handleCloseClick","_handleBgCloseClick","_handleContentScroll","_handleKeyDown"],k={background:"rgba(255 , 255, 255 ,0.8)",bottom:"0",display:"none",height:"100%",left:"0",position:"fixed",right:"0",top:"0",width:"100%"},x=window.wafer.utils,O=x.bindEvent,j=x.findAncestor,E=x.getTemplateContent,T=x.throttle,B=x.unbindEvent,S=window.wafer.base,P=window.wafer.controllers.WaferBaseController,L=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=e.containerClass,n=void 0===o?null:o,i=e.root,a=void 0===i?document:i,s=e.selector,c=e.src,u=void 0===c?"data-wf-lightbox":c,f=e.successClass,p=void 0===f?"wafer-lightbox-loaded":f,d=e.scrollDelay,h=void 0===d?25:d;r(this,t);var w=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{root:a,selector:s,WaferClass:b}));w._options=v({},w._options,{props:{},container:!!n&&a.getElementsByClassName(n),src:u,successClass:p}),C.forEach(function(e){w[e]=w[e].bind(w)}),w._handleContentScrollWithThrottle=T(function(){return w._handleContentScroll.call(w)},h,w),w._state=v({},w._state,{closeElem:null,currentInstance:null,lastScrollY:0});var y=w;return b.prototype.willOpen=function(){if(_){var e=window.scrollY||0;Object.assign(document.body.style,{overflow:"hidden",position:"fixed",top:"-"+e+"px",width:"100%"}),y._state.lastScrollY=e}},w._renderLightBoxWrapper(),w.sync(),w}return i(t,e),g(t,[{key:"_close",value:function(){var e=this._options.props.wrapperMap,t=e.contentElem,o=e.elem,n=e.wrapperElem;document.body.classList.remove("wafer-lightbox-open"),n.classList.remove("wafer-lightbox-open"),S.destroy(t),S.lock(t),S.unlock(document.body),_?(Object.assign(document.body.style,{overflow:"initial",position:"",top:""}),window.scrollTo(0,this._state.lastScrollY||0),this._state.lastScrollY=0):Object.assign(document.body.style,{overflow:"initial"}),Object.assign(o.style,{display:"none"}),S.emitWaferEvent("lightbox:close",{elem:o,meta:{}})}},{key:"_handleCloseClick",value:function(e){e.preventDefault(),this._close()}},{key:"_handleBgCloseClick",value:function(e){var t=this._options.props.wrapperMap,o=t.wrapperElem;e.target===o&&this._close()}},{key:"_handleContentScroll",value:function(){S._handleScroll()}},{key:"_handleKeyDown",value:function(e){switch(e=e||window.event,e.keyCode){case 27:this._close()}}},{key:"handleEvent",value:function(e,o,n){if(m(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"handleEvent",this).call(this,e,o,n),n&&"click"===n.type){var r=n.target;if(r===this._state.closeButton)return;if(r.className&&r.classList.contains("wafer-lightbox-close")&&this._close(),_){var l=j(r,this._options.selector);this._state.currentInstance=l}}}},{key:"willDestroy",value:function(){var e=this._options.props.wrapperMap,t=e.wrapperElem,o=e.closeElem;B(t,"scroll",this._handleContentScrollWithThrottle),o&&B(o,"click",this._handleCloseClick),B(t,"keydown",this._handleKeyDown),B(t,"click",this._handleBgCloseClick)}},{key:"_renderLightBoxWrapper",value:function(){var e=document.createElement("div"),t=document.getElementById("wafer-lightbox-wrapper-template"),o=E(t);if(o){e.className=t.className,e.classList.add("wafer-lightbox-overlay"),Object.assign(e.style,k),e.innerHTML=o;var n=e.getElementsByClassName("wafer-lightbox-wrapper")[0],r=e.getElementsByClassName("wafer-lightbox-content")[0],l=e.getElementsByClassName("wafer-lightbox-close")[0];this._state.closeButton=l,document.body.appendChild(e),l&&O(l,"click",this._handleCloseClick,{passive:!1}),O(n,"keydown",this._handleKeyDown),O(n,"scroll",this._handleContentScrollWithThrottle),O(n,"click",this._handleBgCloseClick),this._options.props={wrapperMap:{elem:e,wrapperElem:n,contentElem:r}}}}}]),t}(P),M=L;t.default=new M({selector:"wafer-lightbox"})}})});